<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EOE 看图猜词</title>
    <link rel="icon" href="images/icon.png" type="image/png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 主容器 -->
    <div id="app">
        <!-- 主页面 -->
        <div id="main-page" class="page active">
            <div class="background"></div>
            <!-- 右上角图标 -->
            <div class="top-icons">
                <button class="icon-btn" onclick="showAnnouncement()">i</button>
                <button class="icon-btn" onclick="showHelp()">?</button>
                <button class="icon-btn" onclick="showSettingsPage()">⚙️</button>
            </div>
            <div class="content">
                <h1 class="outlined-text">EOE看图猜词</h1>
                <div class="decoration">- * - * -</div>
                <div class="button-group-vertical">
                    <button class="rounded-button" onclick="showSelectBankPage()">开始游戏</button>
                    <button class="rounded-button" onclick="showAddBankPage()">我要出题</button>
                    <button class="rounded-button" onclick="showSettingsPage()">设置</button>
                </div>
            </div>
            <div class="bottom-text">Made with Love</div>
        </div>

        <!-- 设置页面 -->
        <div id="settings-page" class="page">
            <div class="background"></div>
            <button class="rounded-button small home-btn" onclick="showMainPage()">返回首页</button>
            <div class="content">
                <h1 class="outlined-text">设置</h1>
                <div class="settings-container">
                    <div class="setting-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <label class="outlined-text">背景音乐开关</label>
                            <button id="bgm-toggle-btn-page" class="bgm-toggle-btn-small" onclick="toggleBgm()">🔇</button>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label class="outlined-text">背景音乐选择</label>
                        <select id="bgm-select-page" class="bgm-select">
                            <option value="bgm.mp3">原版bgm</option>
                            <option value="bgm2.mp3">My Jealousy（露早入阵曲）</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label class="outlined-text">背景音乐音量</label>
                        <input type="range" id="bgm-volume-page" min="0" max="1" step="0.1" value="0.5">
                    </div>
                    <div class="setting-item">
                        <label class="outlined-text">音效音量</label>
                        <input type="range" id="sfx-volume-page" min="0" max="1" step="0.1" value="0.5">
                    </div>
                </div>
            </div>
        </div>

        <!-- 选择题库页面 -->
        <div id="select-bank-page" class="page">
            <div class="background"></div>
            <div class="page-content">
                <button class="rounded-button small home-btn" onclick="showMainPage()">返回首页</button>
                <h1 class="outlined-text title">选择题库</h1>
                <div class="bank-list-container">
                    <div id="select-bank-list" class="bank-list"></div>
                </div>
            </div>
        </div>

        <!-- 编辑题库页面 -->
        <div id="edit-bank-page" class="page">
            <div class="background"></div>
            <div class="page-content">
                <button class="rounded-button small home-btn" onclick="showMainPage()">返回首页</button>
                <!-- 右上角图标 -->
                <div class="top-icons">
                    <button class="icon-btn" onclick="showAnnouncement()">i</button>
                    <button class="icon-btn" onclick="showHelp()">?</button>
                    <button class="icon-btn" onclick="showSettingsPage()">⚙️</button>
                </div>
                <h1 class="outlined-text title">我要出题</h1>
                <div style="text-align: center; margin-bottom: 20px; font-size: 14px; color: #666;"><strong>tips：编辑完题库记得保存和导出哦，不然一刷新就没了，保存后的题库也可以在开始游戏的选择题库页面导出;_;</strong></div>
                
                <div class="form-section">
                    <div class="bank-info">
                        <div class="bank-info-item">
                            <input type="text" id="edit-bank-name" placeholder="题库名称" value="新题库">
                        </div>
                        <div class="bank-info-item">
                            <input type="text" id="edit-author" placeholder="作者">
                        </div>
                    </div>
                    
                    <div id="question-info" class="question-info outlined-text">第 1 / 1 题 (有效: 0)</div>
                </div>
                
                <div class="main-content">
                    <div class="edit-left">
                        <h3 class="outlined-text">题目图片 (点击上传)</h3>
                        <div id="img-button" class="image-button" onclick="editorUploadImage()">
                            <span>点击此处上传图片</span>
                            <img id="preview-image" src="" alt="预览图" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="edit-right">
                        <div class="form-item">
                            <label class="outlined-text">问题:</label>
                            <input type="text" id="edit-question" placeholder="请输入问题">
                        </div>
                        <div class="form-item">
                            <label class="outlined-text">答案:</label>
                            <input type="text" id="edit-answer" placeholder="请输入答案">
                        </div>
                        <div class="form-item">
                            <label class="outlined-text">提示:</label>
                            <input type="text" id="edit-hint" placeholder="请输入提示">
                        </div>
                    </div>
                </div>
                
                <div class="edit-buttons">
                    <button class="rounded-button" onclick="editorPrev()">上一题</button>
                    <button class="rounded-button" onclick="editorNext()">下一题</button>
                    <button class="rounded-button" onclick="editorClear()">清除本题</button>
                    <button class="rounded-button success" onclick="editorSave()">保存题库</button>
                    <button class="rounded-button success" onclick="exportBank()">导出题库</button>
                </div>
            </div>
        </div>

        <!-- 游戏页面 -->
        <div id="game-page" class="page">
            <div class="background"></div>
            <button class="rounded-button small home-btn" onclick="showMainPage()">返回首页</button>
            
            <!-- 右上角图标 -->
            <div class="top-icons">
                <button class="icon-btn" onclick="showAnnouncement()">i</button>
                <button class="icon-btn" onclick="showHelp()">?</button>
                <button class="icon-btn" onclick="showSettingsPage()">⚙️</button>
            </div>
            
            <div class="game-container">
                <!-- 左侧单张图片 -->
                <div class="game-left">
                    <!-- 图片框上方的ID和作者信息 -->
                    <div class="top-info">
                        <span id="game-id" class="outlined-text">ID 72</span>
                        <span id="game-author" class="outlined-text">作者: GIG</span>
                    </div>
                    <div class="image-box">
                        <img id="game-image" src="" alt="游戏图片">
                        <div class="image-text" id="game-text">这是____</div>
                    </div>
                </div>
                
                <!-- 右侧答题区域 -->
                <div class="game-right">
                    <div class="answer-section">
                    <!-- 错误答案显示区域 -->
                    <div id="wrong-answers" class="wrong-answers"></div>
                    
                    <!-- 结果文本区域 -->
                    <div id="result-text" class="outlined-text"></div>
                    
                    <div class="answer-inputs">
                        <input type="text" class="answer-input" maxlength="1" placeholder="">
                        <input type="text" class="answer-input" maxlength="1" placeholder="">
                        <input type="text" class="answer-input" maxlength="1" placeholder="">
                        <input type="text" class="answer-input" maxlength="1" placeholder="">
                    </div>
                    <div class="answer-buttons">
                        <button class="rounded-button" onclick="checkAnswer()">回答</button>
                        <button class="rounded-button" onclick="showHint()">提示</button>
                        <button class="rounded-button" onclick="giveUp()">放弃</button>
                    </div>
                </div>
                    <div id="next-btn-container" style="display: none;">
                        <button class="rounded-button success" onclick="nextQuestion()">下一题</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 游戏完成页面 -->
        <div id="complete-page" class="page">
            <div class="background"></div>
            <div class="content">
                <h1 class="outlined-text success">恭喜通关！</h1>
                <div class="decoration">- * - * - * -</div>
                <div class="stats-container">
                    <h3 class="outlined-text">游戏统计</h3>
                    <div id="stats-correct" class="outlined-text success"></div>
                    <div id="stats-wrong" class="outlined-text error"></div>
                    <div id="stats-accuracy" class="outlined-text"></div>
                </div>
                <button class="rounded-button" onclick="showMainPage()">返回主界面</button>
            </div>
        </div>
    </div>

    <!-- 隐藏的文件输入 -->
    <input type="file" id="file-input" style="display: none;" accept="image/jpeg,image/png,image/gif,image/webp">
    <input type="file" id="bank-import-input" style="display: none;">

    <!-- 加载进度条 -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-container">
            <h2 class="outlined-text">正在加载游戏资源...（初次加载可能较慢，请耐心等待）</h2>
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
                <div id="progress-text" class="outlined-text">0%</div>
            </div>
        </div>
    </div>

    <!-- 设置弹窗 -->
    <div id="settings-modal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="outlined-text">设置</h1>
                <button class="close-btn" onclick="closeSettingsModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="settings-container">
                    <div class="setting-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <label class="outlined-text">背景音乐开关</label>
                            <button id="bgm-toggle-btn" class="bgm-toggle-btn-small" onclick="toggleBgm()">🔇</button>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label class="outlined-text">背景音乐选择</label>
                        <select id="bgm-select" class="bgm-select">
                            <option value="bgm.mp3">原版bgm</option>
                            <option value="bgm2.mp3">My Jealousy（露早入阵曲）</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label class="outlined-text">背景音乐音量</label>
                        <input type="range" id="bgm-volume" min="0" max="1" step="0.1" value="0.5">
                    </div>
                    <div class="setting-item">
                        <label class="outlined-text">音效音量</label>
                        <input type="range" id="sfx-volume" min="0" max="1" step="0.1" value="0.5">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 帮助弹窗 -->
    <div id="help-modal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="outlined-text">游戏规则</h1>
                <button class="close-btn" onclick="closeHelpModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <div class="outlined-text" style="text-align: left; line-height: 1.8; font-size: 18px; margin-bottom: 20px;">
                        <p>1. 观察图片</p>
                        <p>2. 根据图片内容猜测词语</p>
                        <p>3. 在输入框输入答案</p>
                        <p>4. 点击回答按钮检查答案，如果部分字对了，对了的字将会变绿</p>
                        <p>5. 点击提示按钮可以获得提示</p>
                    </div>
                    <div class="outlined-text" style="text-align: center; font-size: 20px; color: #FF6B6B;">希望大家玩的开心！</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 公告弹窗 -->
    <div id="announcement-modal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="outlined-text">公告</h1>
                <button class="close-btn" onclick="closeAnnouncementModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <div class="outlined-text" style="text-align: left; line-height: 1.8; font-size: 18px; margin-bottom: 20px;">
                        <p style="text-indent: 2em;">EOE谐音梗挑战网页版已经正式上线啦，欢迎大家前来游玩，有任何意见建议或者bug的话，可以和网页版作者B站私信反馈。想投稿题目的话可以在首页点击我要出题，编辑完成后点击导出题库，将题目压缩包发到提示的邮箱里就行啦，祝大家玩的开心。</p>
                        <br>
                        <p>网页版作者：<a href="https://space.bilibili.com/3690980530195127" target="_blank">@柚想起她</a></p>
                        <p>游戏原作者：<a href="https://space.bilibili.com/142025" target="_blank">@Oneiric_Dairy</a></p>
                        <br>
                        <p>喜欢的话可以给我们b站点个关注，感谢大家!</p>
                        <p>对了，不要忘记看<a href="https://space.bilibili.com/1795147802" target="_blank">@柚恩不加糖</a>，<a href="https://space.bilibili.com/1669777785" target="_blank">@露早gogo</a>的直播呦❤</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 导出成功弹窗 -->
    <div id="export-success-modal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="outlined-text success">导出成功</h1>
                <button class="close-btn" onclick="closeExportSuccessModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <div class="outlined-text" style="text-align: center; line-height: 1.8; font-size: 18px; margin-bottom: 20px;">
                        <p>导出成功，欢迎投稿至我的邮箱</p>
                        <p style="font-size: 20px; color: #4ECDC4;">721425889@qq.com</p>
                        <p>作者技术力有限，做不到创意工坊的水平，暂时会用这种方式更新，质量好的话我会及时上传到网站上给大家游玩的。</p>
                        <p style="margin-top: 20px; color: #FF6B6B;">感谢大家的支持！</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="script.js"></script>
</body>
</html>